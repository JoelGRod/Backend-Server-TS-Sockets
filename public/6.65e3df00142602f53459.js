(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"2yxt":function(e,t,o){"use strict";o.r(t),o.d(t,"ChatModule",function(){return Be});var i=o("ofXK"),r=o("3Pt+"),n=o("tyNb"),s=o("fXoL"),a=o("N/25"),c=o("XhcP"),l=o("/t3+"),m=o("bTqV"),b=o("NFeN"),u=o("MutI");function _(e,t){if(1&e){const e=s.Rb();s.Qb(0,"a",10),s.Yb("click",function(){return s.mc(e),s.cc(),s.lc(2).toggle()}),s.Qb(1,"mat-icon",11),s.uc(2),s.Pb(),s.Qb(3,"span"),s.uc(4),s.Pb(),s.Pb()}if(2&e){const e=t.$implicit;s.hc("routerLink",e.route),s.Bb(2),s.vc(e.icon),s.Bb(2),s.vc(e.name)}}let d=(()=>{class e{constructor(){this.user_name="",this.menu_items=[{route:"./chat/menu",icon:"label",name:"Chat"}],this.onLogout=new s.n}logout(){this.onLogout.emit("logout")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Fb({type:e,selectors:[["app-main-menu"]],inputs:{user_name:"user_name",menu_items:"menu_items"},outputs:{onLogout:"onLogout"},decls:22,vars:2,consts:[["fullscreen",""],["mode","push"],["sidenav",""],["color","primary"],[1,"spacer"],["mat-icon-button","",3,"click"],["mat-list-item","",3,"routerLink","click",4,"ngFor","ngForOf"],[1,"pe-4"],[1,"mx-3"],["mat-flat-button","",3,"click"],["mat-list-item","",3,"routerLink","click"],["mat-list-icon",""]],template:function(e,t){if(1&e){const e=s.Rb();s.Qb(0,"mat-sidenav-container",0),s.Qb(1,"mat-sidenav",1,2),s.Qb(3,"mat-toolbar",3),s.Qb(4,"span"),s.uc(5,"Menu"),s.Pb(),s.Mb(6,"span",4),s.Qb(7,"button",5),s.Yb("click",function(){return s.mc(e),s.lc(2).toggle()}),s.Qb(8,"mat-icon"),s.uc(9,"menu"),s.Pb(),s.Pb(),s.Pb(),s.Qb(10,"mat-nav-list"),s.sc(11,_,5,3,"a",6),s.Pb(),s.Pb(),s.Qb(12,"mat-toolbar",7),s.Qb(13,"button",5),s.Yb("click",function(){return s.mc(e),s.lc(2).toggle()}),s.Qb(14,"mat-icon"),s.uc(15,"menu"),s.Pb(),s.Pb(),s.Mb(16,"span",4),s.Qb(17,"span",8),s.uc(18),s.Pb(),s.Qb(19,"button",9),s.Yb("click",function(){return t.logout()}),s.uc(20," logout "),s.Pb(),s.Pb(),s.Mb(21,"router-outlet"),s.Pb()}2&e&&(s.Bb(11),s.hc("ngForOf",t.menu_items),s.Bb(7),s.vc(t.user_name))},directives:[c.b,c.a,l.a,m.a,b.a,u.f,i.j,n.f,u.c,n.d,u.b],styles:[""]}),e})();var h=o("7JkF");let p=(()=>{class e{constructor(e){this.socket=e,this._socket_status=!1,this.check_status()}get socket_status(){return this._socket_status}check_status(){this.socket.on("connect",()=>{console.log("Connected to server"),this._socket_status=!0}),this.socket.on("disconnect",()=>{console.log("Disconnected from server"),this._socket_status=!1})}emit(e,t,o){this.socket.emit(e,t,o)}listen(e){return this.socket.fromEvent(e)}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(h.a))},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function f(e,t){1&e&&(s.Qb(0,"span",3),s.uc(1,"Online"),s.Pb())}function g(e,t){1&e&&(s.Qb(0,"span",4),s.uc(1,"Offline"),s.Pb())}let v=(()=>{class e{constructor(e){this.ws_service=e}get socket_status(){return this.ws_service.socket_status}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(p))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-footer"]],decls:4,vars:2,consts:[[1,"p-2","bg-dark","text-white","text-end","my-footer"],["class","text-success",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-success"],[1,"text-danger"]],template:function(e,t){1&e&&(s.Qb(0,"footer",0),s.uc(1," Server Status: "),s.sc(2,f,2,0,"span",1),s.sc(3,g,2,0,"span",2),s.Pb()),2&e&&(s.Bb(2),s.hc("ngIf",t.socket_status),s.Bb(1),s.hc("ngIf",!t.socket_status))},directives:[i.k],styles:["footer.my-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;z-index:1}"]}),e})(),P=(()=>{class e{constructor(e,t){this._auth_service=e,this._router=t,this.menu_items=[{route:"/home",icon:"home",name:"Home"},{route:"/chat/menu",icon:"question_answer",name:"Chat"},{route:"/auth/login",icon:"input",name:"Login"},{route:"/auth/register",icon:"app_registration",name:"Register"}]}get user_name(){return this._auth_service.user.name}ngOnInit(){}logout(){this._router.navigateByUrl("/auth/login"),this._auth_service.logout()}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(a.a),s.Lb(n.b))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-main"]],decls:2,vars:2,consts:[[3,"user_name","menu_items","onLogout"]],template:function(e,t){1&e&&(s.Qb(0,"app-main-menu",0),s.Yb("onLogout",function(){return t.logout()}),s.Pb(),s.Mb(1,"app-footer")),2&e&&s.hc("user_name",t.user_name)("menu_items",t.menu_items)},directives:[d,v],styles:[""]}),e})();var w=o("iELJ"),k=o("Q2Ze"),Q=o("e6WT"),x=o("pMoy");function y(e,t){1&e&&(s.Qb(0,"mat-form-field"),s.Qb(1,"mat-label"),s.uc(2,"Password"),s.Pb(),s.Mb(3,"input",11),s.Pb())}let O=(()=>{class e{constructor(e,t){this._dialogRef=e,this._fb=t,this.form=this._fb.group({room_name:["",[r.m.required]],desc:["One more room",[r.m.required]],photo:["A room photo...",[r.m.required]],password:[""],has_password:[!1]})}exit(){this._dialogRef.close()}send_data(){this.form.invalid?this.form.markAllAsTouched():this._dialogRef.close(this.form.value)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(w.f),s.Lb(r.c))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-create-room-dialog"]],decls:24,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["matInput","","formControlName","room_name"],["matInput","","formControlName","desc"],["matInput","","formControlName","photo"],["formControlName","has_password"],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"],["matInput","","formControlName","password"]],template:function(e,t){1&e&&(s.Qb(0,"h1",0),s.uc(1,"New Room"),s.Pb(),s.Qb(2,"div",1),s.Qb(3,"form",2),s.Qb(4,"mat-form-field"),s.Qb(5,"mat-label"),s.uc(6,"Room name"),s.Pb(),s.Mb(7,"input",3),s.Pb(),s.Qb(8,"mat-form-field"),s.Qb(9,"mat-label"),s.uc(10,"Description"),s.Pb(),s.Mb(11,"input",4),s.Pb(),s.Qb(12,"mat-form-field"),s.Qb(13,"mat-label"),s.uc(14,"Photo URL"),s.Pb(),s.Mb(15,"input",5),s.Pb(),s.Qb(16,"mat-checkbox",6),s.uc(17,"I want a password!"),s.Pb(),s.sc(18,y,4,0,"mat-form-field",7),s.Pb(),s.Pb(),s.Qb(19,"div",8),s.Qb(20,"button",9),s.Yb("click",function(){return t.exit()}),s.uc(21," Go out! "),s.Pb(),s.Qb(22,"button",10),s.Yb("click",function(){return t.send_data()}),s.uc(23," Create Room "),s.Pb(),s.Pb()),2&e&&(s.Bb(3),s.hc("formGroup",t.form),s.Bb(15),s.hc("ngIf",t.form.get("has_password").value))},directives:[w.g,w.d,r.n,r.j,r.e,k.b,k.e,Q.a,r.b,r.i,r.d,x.a,i.k,w.c,m.a],styles:[""]}),e})(),I=(()=>{class e{constructor(e,t){this._dialogRef=e,this._fb=t,this.form=this._fb.group({nickname:["",[r.m.required]],desc:["One more profile",[r.m.required]],photo:["A profile photo...",[r.m.required]]})}exit(){this._dialogRef.close()}send_data(){this.form.invalid?this.form.markAllAsTouched():this._dialogRef.close(this.form.value)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(w.f),s.Lb(r.c))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-create-profile-dialog"]],decls:21,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["matInput","","formControlName","nickname"],["matInput","","formControlName","desc"],["matInput","","formControlName","photo"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"h1",0),s.uc(1,"New Profile"),s.Pb(),s.Qb(2,"div",1),s.Qb(3,"form",2),s.Qb(4,"mat-form-field"),s.Qb(5,"mat-label"),s.uc(6,"Nickname"),s.Pb(),s.Mb(7,"input",3),s.Pb(),s.Qb(8,"mat-form-field"),s.Qb(9,"mat-label"),s.uc(10,"Description"),s.Pb(),s.Mb(11,"input",4),s.Pb(),s.Qb(12,"mat-form-field"),s.Qb(13,"mat-label"),s.uc(14,"Photo URL"),s.Pb(),s.Mb(15,"input",5),s.Pb(),s.Pb(),s.Pb(),s.Qb(16,"div",6),s.Qb(17,"button",7),s.Yb("click",function(){return t.exit()}),s.uc(18," Go out! "),s.Pb(),s.Qb(19,"button",8),s.Yb("click",function(){return t.send_data()}),s.uc(20," Create Profile "),s.Pb(),s.Pb()),2&e&&(s.Bb(3),s.hc("formGroup",t.form))},directives:[w.g,w.d,r.n,r.j,r.e,k.b,k.e,Q.a,r.b,r.i,r.d,w.c,m.a],styles:[""]}),e})();var C=o("zQhy");function M(e,t){if(1&e&&(s.Qb(0,"mat-radio-button",8),s.uc(1),s.Pb()),2&e){const e=t.$implicit;s.hc("value",e.nickname),s.Bb(1),s.wc(" ",e.nickname," ")}}let j=(()=>{class e{constructor(e,t,o){this._dialogRef=e,this.profiles=t,this._fb=o,this.form=this._fb.group({nickname:["",[r.m.required]]})}exit(){this._dialogRef.close()}send_data(){this.form.invalid?this.form.markAllAsTouched():this._dialogRef.close(this.form.get("nickname").value)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(w.f),s.Lb(w.a),s.Lb(r.c))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-select-dialog"]],decls:11,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["aria-labelledby","Nickname radio froup","formControlName","nickname",1,"d-flex","flex-column","mb-3"],["class","m-1",3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"],[1,"m-1",3,"value"]],template:function(e,t){1&e&&(s.Qb(0,"h1",0),s.uc(1,"Select a profile"),s.Pb(),s.Qb(2,"div",1),s.Qb(3,"form",2),s.Qb(4,"mat-radio-group",3),s.sc(5,M,2,2,"mat-radio-button",4),s.Pb(),s.Pb(),s.Pb(),s.Qb(6,"div",5),s.Qb(7,"button",6),s.Yb("click",function(){return t.exit()}),s.uc(8," Go out! "),s.Pb(),s.Qb(9,"button",7),s.Yb("click",function(){return t.send_data()}),s.uc(10," Ok "),s.Pb(),s.Pb()),2&e&&(s.Bb(3),s.hc("formGroup",t.form),s.Bb(2),s.hc("ngForOf",t.profiles))},directives:[w.g,w.d,r.n,r.j,r.e,C.b,r.i,r.d,i.j,w.c,m.a,C.a],styles:[""]}),e})(),B=(()=>{class e{constructor(e,t){this._dialogRef=e,this._fb=t,this.form=this._fb.group({password:["",[r.m.required]]})}exit(){this._dialogRef.close()}send_data(){this.form.invalid?this.form.markAllAsTouched():this._dialogRef.close(this.form.get("password").value)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(w.f),s.Lb(r.c))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-password-dialog"]],decls:13,vars:1,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[3,"formGroup"],["matInput","","formControlName","password"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"h1",0),s.uc(1,"Enter Room Password"),s.Pb(),s.Qb(2,"div",1),s.Qb(3,"form",2),s.Qb(4,"mat-form-field"),s.Qb(5,"mat-label"),s.uc(6,"Room Password"),s.Pb(),s.Mb(7,"input",3),s.Pb(),s.Pb(),s.Pb(),s.Qb(8,"div",4),s.Qb(9,"button",5),s.Yb("click",function(){return t.exit()}),s.uc(10," Go out! "),s.Pb(),s.Qb(11,"button",6),s.Yb("click",function(){return t.send_data()}),s.uc(12," Ok "),s.Pb(),s.Pb()),2&e&&(s.Bb(3),s.hc("formGroup",t.form))},directives:[w.g,w.d,r.n,r.j,r.e,k.b,k.e,Q.a,r.b,r.i,r.d,w.c,m.a],styles:[""]}),e})();var R=o("tuG+"),L=o("tk/3"),F=o("AytR"),G=o("LRne"),Y=o("JIr8"),S=o("lJxs");let D=(()=>{class e{constructor(e,t){this.ws_service=e,this._http=t,this._base_url=F.a.base_url}create_room(e){return e=Object.assign(Object.assign({},e),{token:localStorage.getItem("token")}),new Promise((t,o)=>{this.ws_service.emit("create-room",e,e=>{e.ok?t(e.room):o(e)})})}get_new_rooms(){return this.ws_service.listen("new-room-created")}delete_room_sockets(e){const t={room_id:e,token:localStorage.getItem("token")};return new Promise((e,o)=>{this.ws_service.emit("delete-room",t,t=>{t.ok?e(t.room):o(t)})})}update_deleted_rooms(){return this.ws_service.listen("room-deleted")}login_room(e){return e=Object.assign(Object.assign({},e),{token:localStorage.getItem("token")}),new Promise((t,o)=>{this.ws_service.emit("login-user",e,e=>{var i;e.ok?t(null===(i=e.room)||void 0===i?void 0:i._id):o(e)})})}listen_new_logged_users(e){return this.ws_service.listen(`${e}-login-user`)}logout_room(e){e=Object.assign(Object.assign({},e),{token:localStorage.getItem("token")}),this.ws_service.emit("logout-user",e,e=>{})}listen_logout_users(e){return this.ws_service.listen(`${e}-logout-user`)}send_message(e){return e=Object.assign(Object.assign({},e),{token:localStorage.getItem("token")}),new Promise((t,o)=>{this.ws_service.emit("message",e,e=>{e.ok?t(e):o(e)})})}get_messages(e){return this.ws_service.listen(`${e}-new-message`)}get_user_profiles(){const e=`${this._base_url}/chat/user-chat-users`,t=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.get(e,{headers:t})}get_user_rooms(){const e=`${this._base_url}/chat/rooms-user`,t=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.get(e,{headers:t})}get_room_profiles(e){const t=`${this._base_url}/chat/room-chat-users`,o=(new L.c).set("x-token",localStorage.getItem("token")),i=(new L.d).set("room_id",e);return this._http.get(t,{headers:o,params:i})}get_all_rooms(){const e=`${this._base_url}/chat/rooms`,t=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.get(e,{headers:t})}get_room(e){const t=`${this._base_url}/chat/room`,o=(new L.c).set("x-token",localStorage.getItem("token")),i=(new L.d).set("room_id",e);return this._http.get(t,{headers:o,params:i})}get_profile(e){const t=`${this._base_url}/chat/chat-user`,o=(new L.c).set("x-token",localStorage.getItem("token")),i=(new L.d).set("profile_id",e);return this._http.get(t,{headers:o,params:i})}get_profile_rooms(e){const t=`${this._base_url}/chat/chat-user-rooms`,o=(new L.c).set("x-token",localStorage.getItem("token")),i=(new L.d).set("profile_id",e);return this._http.get(t,{headers:o,params:i})}create_user_profile(e){const t=`${this._base_url}/chat/create-chat-user`,o=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.post(t,e,{headers:o}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}delete_room(e){const t=`${this._base_url}/chat/delete-chat-room`,o=(new L.c).set("x-token",localStorage.getItem("token")),i=(new L.d).set("room_id",e);return this._http.delete(t,{params:i,headers:o}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}delete_profile(e){const t=`${this._base_url}/chat/delete-chat-user`,o=(new L.c).set("x-token",localStorage.getItem("token")),i=(new L.d).set("chat_user_id",e);return this._http.delete(t,{params:i,headers:o}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}check_if_profile_can_loggin(e,t){const o=`${this._base_url}/chat/check-room-login`,i=(new L.c).set("x-token",localStorage.getItem("token")),r=(new L.d).set("room_id",t).set("profile_id",e);return this._http.get(o,{headers:i,params:r}).pipe(Object(S.a)(e=>!0),Object(Y.a)(e=>Object(G.a)(!1)))}update_profile_nickname(e,t){const o=`${this._base_url}/chat/update-chat-user-nickname`,i=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.put(o,{new_nickname:t,chat_user_id:e},{headers:i}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}update_profile_info(e,t,o){const i=`${this._base_url}/chat/update-chat-user-info`,r=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.put(i,{new_desc:t,new_photo:o,chat_user_id:e},{headers:r}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}update_room_name(e,t){const o=`${this._base_url}/chat/update-room-name`,i=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.put(o,{new_name:t,room_id:e},{headers:i}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}update_room_info(e,t,o){const i=`${this._base_url}/chat/update-room-info`,r=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.put(i,{new_desc:t,new_photo:o,room_id:e},{headers:r}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}update_room_password(e,t,o){const i=`${this._base_url}/chat/update-room-password`,r=(new L.c).set("x-token",localStorage.getItem("token"));return this._http.put(i,{new_password:t,old_password:o,room_id:e},{headers:r}).pipe(Object(Y.a)(e=>Object(G.a)(e.error)))}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(p),s.Ub(L.a))},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var N=o("Ynp+"),$=o("f0Cb"),E=o("FKr1");function A(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",8),s.Yb("click",function(){s.mc(e);const t=s.cc().$implicit;return s.cc().emit_object("delete","room",t._id)}),s.Qb(1,"mat-icon"),s.uc(2,"delete"),s.Pb(),s.Pb()}}function T(e,t){if(1&e){const e=s.Rb();s.Qb(0,"mat-list-item"),s.Qb(1,"mat-icon",2),s.Qb(2,"img",3),s.Yb("error",function(t){return s.mc(e),s.cc().changeSource(t)}),s.Pb(),s.Pb(),s.Qb(3,"div",4),s.uc(4),s.Pb(),s.Qb(5,"div",4),s.uc(6),s.dc(7,"date"),s.Pb(),s.Qb(8,"button",5),s.Yb("click",function(){s.mc(e);const o=t.$implicit;return s.cc().emit_object("login","room",o._id)}),s.Qb(9,"mat-icon"),s.uc(10,"login"),s.Pb(),s.Pb(),s.Qb(11,"button",6),s.Qb(12,"mat-icon"),s.uc(13,"view_list"),s.Pb(),s.Pb(),s.sc(14,A,3,0,"button",7),s.Pb()}if(2&e){const e=t.$implicit,o=s.cc();s.Bb(2),s.hc("src",e.photo,s.nc),s.Bb(2),s.vc(e.name),s.Bb(2),s.wc(" ",s.ec(7,5,e.created_at)," "),s.Bb(5),s.hc("routerLink","/chat/room-config/"+e._id),s.Bb(3),s.hc("ngIf",!o.is_general)}}let U=(()=>{class e{constructor(){this.chat_list_type="",this.rooms=[],this.is_general=!0,this.on_emit_object=new s.n}emit_object(e,t,o){this.on_emit_object.emit({id:o,action:e,subject:t})}changeSource(e){e.target.src=F.a.empty_chat_photo}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Fb({type:e,selectors:[["app-chat-list"]],inputs:{chat_list_type:"chat_list_type",rooms:"rooms",is_general:"is_general"},outputs:{on_emit_object:"on_emit_object"},decls:5,vars:2,consts:[["mat-subheader",""],[4,"ngFor","ngForOf"],["mat-list-icon","",1,"mb-4","pe-3"],["alt","room image",1,"header-img",3,"src","error"],["mat-line",""],["mat-mini-fab","","aria-label","Enter room button","color","basic",3,"click"],["mat-mini-fab","","aria-label","View room info button","color","primary",1,"mx-2","mx-md-4",3,"routerLink"],["mat-mini-fab","","aria-label","Delete chat room button","color","warn",3,"click",4,"ngIf"],["mat-mini-fab","","aria-label","Delete chat room button","color","warn",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"mat-list"),s.Qb(1,"div",0),s.uc(2),s.Pb(),s.sc(3,T,15,7,"mat-list-item",1),s.Mb(4,"mat-divider"),s.Pb()),2&e&&(s.Bb(2),s.vc(t.chat_list_type),s.Bb(1),s.hc("ngForOf",t.rooms))},directives:[u.a,u.e,i.j,$.a,u.c,b.a,u.b,E.d,m.a,n.c,i.k],pipes:[i.d],styles:[".header-img[_ngcontent-%COMP%] {\n      vertical-align: middle;\n      width: 45px;\n      height: 45px;\n      border-radius: 50%;\n    }"]}),e})();function q(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",7),s.Yb("click",function(){s.mc(e);const t=s.cc().$implicit;return s.cc().emit_id(t._id)}),s.Qb(1,"mat-icon"),s.uc(2,"delete"),s.Pb(),s.Pb()}}function J(e,t){if(1&e){const e=s.Rb();s.Qb(0,"mat-list-item"),s.Qb(1,"mat-icon",2),s.Qb(2,"img",3),s.Yb("error",function(t){return s.mc(e),s.cc().changeSource(t)}),s.Pb(),s.Pb(),s.Qb(3,"div",4),s.uc(4),s.Pb(),s.Qb(5,"div",4),s.uc(6),s.dc(7,"date"),s.Pb(),s.Qb(8,"button",5),s.Qb(9,"mat-icon"),s.uc(10,"view_list"),s.Pb(),s.Pb(),s.sc(11,q,3,0,"button",6),s.Pb()}if(2&e){const e=t.$implicit,o=s.cc();s.Bb(2),s.hc("src",e.photo,s.nc),s.Bb(2),s.vc(e.nickname),s.Bb(2),s.wc(" ",s.ec(7,5,e.created_at)," "),s.Bb(2),s.hc("routerLink","/chat/profile/"+e._id),s.Bb(3),s.hc("ngIf",!o.is_general)}}let V=(()=>{class e{constructor(){this.user_list_type="",this.profiles=[],this.is_general=!0,this.on_emit=new s.n}emit_id(e){this.on_emit.emit(e)}changeSource(e){e.target.src=F.a.empty_profile_photo}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Fb({type:e,selectors:[["app-user-list"]],inputs:{user_list_type:"user_list_type",profiles:"profiles",is_general:"is_general"},outputs:{on_emit:"on_emit"},decls:5,vars:2,consts:[["mat-subheader",""],[4,"ngFor","ngForOf"],["mat-list-icon","",1,"mb-4","pe-3"],["alt","profile image",1,"header-img",3,"src","error"],["mat-line",""],["mat-mini-fab","","aria-label","View profile info button","color","primary",1,"mx-2","mx-md-4",3,"routerLink"],["mat-mini-fab","","aria-label","Delete profile button","color","warn",3,"click",4,"ngIf"],["mat-mini-fab","","aria-label","Delete profile button","color","warn",3,"click"]],template:function(e,t){1&e&&(s.Qb(0,"mat-list"),s.Qb(1,"div",0),s.uc(2),s.Pb(),s.sc(3,J,12,7,"mat-list-item",1),s.Mb(4,"mat-divider"),s.Pb()),2&e&&(s.Bb(2),s.vc(t.user_list_type),s.Bb(1),s.hc("ngForOf",t.profiles))},directives:[u.a,u.e,i.j,$.a,u.c,b.a,u.b,E.d,m.a,n.c,i.k],pipes:[i.d],styles:[".header-img[_ngcontent-%COMP%] {\n    vertical-align: middle;\n    width: 45px;\n    height: 45px;\n    border-radius: 50%;\n  }"]}),e})();function H(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div"),s.Qb(1,"app-chat-list",12),s.Yb("on_emit_object",function(t){return s.mc(e),s.cc().get_actions(t)}),s.Pb(),s.Pb()}if(2&e){const e=s.cc();s.Bb(1),s.hc("chat_list_type","My Chats")("rooms",e.user_rooms)("is_general",!1)}}function z(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div"),s.Qb(1,"app-chat-list",13),s.Yb("on_emit_object",function(t){return s.mc(e),s.cc().get_actions(t)}),s.Pb(),s.Pb()}if(2&e){const e=s.cc();s.Bb(1),s.hc("chat_list_type","General Chats")("rooms",e.all_rooms)}}function X(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div"),s.Qb(1,"app-user-list",14),s.Yb("on_emit",function(t){return s.mc(e),s.cc().delete_profile_dialog(t)}),s.Pb(),s.Pb()}if(2&e){const e=s.cc();s.Bb(1),s.hc("user_list_type","My Profiles")("profiles",e.user_profiles)("is_general",!1)}}function K(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",15),s.Yb("click",function(){return s.mc(e),s.cc().openRoomDialog()}),s.Qb(1,"mat-icon"),s.uc(2,"add"),s.Pb(),s.Pb()}}function W(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",15),s.Yb("click",function(){return s.mc(e),s.cc().openProfileDialog()}),s.Qb(1,"mat-icon"),s.uc(2,"add"),s.Pb(),s.Pb()}}let Z=(()=>{class e{constructor(e,t,o){this._chat_service=e,this._dialog=t,this._router=o,this.view="my-chats",this.user_rooms=[],this.user_profiles=[],this.all_rooms=[]}ngOnInit(){this._user_rooms_subs=this._chat_service.get_user_rooms().subscribe(e=>{e.ok&&(this.user_rooms=e.rooms)}),this._user_profiles_subs=this._chat_service.get_user_profiles().subscribe(e=>{e.ok&&(this.user_profiles=e.profiles)}),this._all_rooms_subs=this._chat_service.get_all_rooms().subscribe(e=>{e.ok&&(this.all_rooms=e.rooms)}),this._new_rooms_subs=this._chat_service.get_new_rooms().subscribe(e=>{this.all_rooms.push(e)}),this._deleted_rooms_subs=this._chat_service.update_deleted_rooms().subscribe(e=>{this.all_rooms=this.delete_element_from_array(this.all_rooms,e)})}ngOnDestroy(){this._user_rooms_subs.unsubscribe(),this._user_profiles_subs.unsubscribe(),this._all_rooms_subs.unsubscribe(),this._new_rooms_subs.unsubscribe(),this._deleted_rooms_subs.unsubscribe()}create_room(e){this._chat_service.create_room(e).then(e=>{this.user_rooms.push(e)}).catch(e=>{this.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}openRoomDialog(){this._dialog.open(O,{width:"300px",height:"400px"}).afterClosed().subscribe(e=>{void 0!==e&&this.create_room(e)})}delete_room(e){this._chat_service.delete_room_sockets(e).then(e=>{this.user_rooms=this.delete_element_from_array(this.user_rooms,e)}).catch(e=>{this.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}delete_room_dialog(e){this.openGeneralDialogResponse({title:"Are you sure?",icon:"warning_amber",msg:"You are about to delete a room...",response:!0}).subscribe(t=>{t&&this.delete_room(e)})}login_checks(e){if(this.is_some_profile_connected(e))return;let t={room_id:e,nickname:"",password:""};this.select_login_profile().subscribe(o=>{if(void 0===o)return;t.nickname=o;const i=this.all_rooms.find(t=>t._id===e);(null==i?void 0:i.has_password)?this.enter_login_password().subscribe(e=>{void 0!==e&&(t.password=e,this.login_room(t))}):this.login_room(t)})}is_some_profile_connected(e){for(let t of this.user_profiles)if(void 0!==t.rooms.find(t=>t===e))return this._router.navigate(["/chat/room",e,t._id]),!0;return!1}select_login_profile(){return this._dialog.open(j,{width:"300px",height:"auto",data:this.user_profiles}).afterClosed()}enter_login_password(){return this._dialog.open(B,{width:"300px",height:"auto"}).afterClosed()}login_room(e){this._chat_service.login_room(e).then(t=>{var o;let i=this.user_profiles.find(t=>t.nickname===e.nickname);null===(o=null==i?void 0:i.rooms)||void 0===o||o.push(t),this._router.navigate(["/chat/room",t,null==i?void 0:i._id])}).catch(e=>{this.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}create_profile(e){this._chat_service.create_user_profile(e).subscribe(e=>{e.ok?this.user_profiles.push(e.profile):this.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}openProfileDialog(){this._dialog.open(I,{width:"300px",height:"325px"}).afterClosed().subscribe(e=>{void 0!==e&&this.create_profile(e)})}delete_profile(e){this._chat_service.delete_profile(e).subscribe(e=>{e.ok?this.user_profiles=this.delete_element_from_array(this.user_profiles,e.profile):this.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}delete_profile_dialog(e){this.openGeneralDialogResponse({title:"Are you sure?",icon:"warning_amber",msg:"You are about to delete a profile...",response:!0}).subscribe(t=>{t&&this.delete_profile(e)})}get_actions(e){"room"===e.subject&&"login"===e.action&&this.login_checks(e.id),"room"===e.subject&&"delete"===e.action&&this.delete_room_dialog(e.id)}change_view(e){this.view=e.value}openGeneralDialog(e){this._dialog.open(R.a,{width:"250px",data:e})}openGeneralDialogResponse(e){return this._dialog.open(R.a,{width:"250px",data:e}).afterClosed()}delete_element_from_array(e,t){return e.filter(e=>e._id!==t._id)}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(D),s.Lb(w.b),s.Lb(n.b))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-menu"]],decls:23,vars:5,consts:[[1,"flex-container","d-flex","flex-column","animate__animated","animate__fadeIn","animation-speed"],[1,"content"],[4,"ngIf"],[1,"footer"],["mat-mini-fab","","color","primary","class","float-end me-2 my-2",3,"click",4,"ngIf"],[1,"row"],[1,"button-group",3,"click"],["group","matButtonToggleGroup"],[1,"col-4"],["value","my-chats","aria-label","Show user connected chats",1,"py-3","button-toggle"],["value","gral-chats","aria-label","Show all chats",1,"py-3","button-toggle"],["value","my-profiles","aria-label","Show user profiles",1,"py-3","button-toggle"],[3,"chat_list_type","rooms","is_general","on_emit_object"],[3,"chat_list_type","rooms","on_emit_object"],[3,"user_list_type","profiles","is_general","on_emit"],["mat-mini-fab","","color","primary",1,"float-end","me-2","my-2",3,"click"]],template:function(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",0),s.Qb(1,"div",1),s.sc(2,H,2,3,"div",2),s.sc(3,z,2,2,"div",2),s.sc(4,X,2,3,"div",2),s.Pb(),s.Qb(5,"div",3),s.sc(6,K,3,0,"button",4),s.sc(7,W,3,0,"button",4),s.Qb(8,"mat-toolbar",5),s.Qb(9,"mat-button-toggle-group",6,7),s.Yb("click",function(){s.mc(e);const o=s.lc(10);return t.change_view(o)}),s.Qb(11,"div",8),s.Qb(12,"mat-button-toggle",9),s.Qb(13,"mat-icon"),s.uc(14,"question_answer"),s.Pb(),s.Pb(),s.Pb(),s.Qb(15,"div",8),s.Qb(16,"mat-button-toggle",10),s.Qb(17,"mat-icon"),s.uc(18,"view_headline"),s.Pb(),s.Pb(),s.Pb(),s.Qb(19,"div",8),s.Qb(20,"mat-button-toggle",11),s.Qb(21,"mat-icon"),s.uc(22,"supervisor_account"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb()}2&e&&(s.Bb(2),s.hc("ngIf","my-chats"===t.view),s.Bb(1),s.hc("ngIf","gral-chats"===t.view),s.Bb(1),s.hc("ngIf","my-profiles"===t.view),s.Bb(2),s.hc("ngIf","my-chats"===t.view),s.Bb(1),s.hc("ngIf","my-profiles"===t.view))},directives:[i.k,l.a,N.b,N.a,b.a,U,V,m.a],styles:[".flex-container[_ngcontent-%COMP%]{height:calc(100% - 92px)}.flex-container-spinner[_ngcontent-%COMP%]{height:50%}@media (min-width:600px){.flex-container[_ngcontent-%COMP%]{height:calc(100% - 100px)}}",".content[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:scroll}.footer[_ngcontent-%COMP%]{flex-shrink:0}.button-group[_ngcontent-%COMP%]{border:none}.button-toggle[_ngcontent-%COMP%]{background:none}"]}),e})();var ee=o("eIep"),te=o("vkgz"),oe=o("H0VJ"),ie=o("Wp6s"),re=o("pu8Q");function ne(e,t){if(1&e){const e=s.Rb();s.Qb(0,"form",14),s.Qb(1,"p",15),s.Qb(2,"mat-form-field",16),s.Qb(3,"mat-label"),s.uc(4,"Nickname"),s.Pb(),s.Mb(5,"input",17),s.Pb(),s.Qb(6,"button",13),s.Yb("click",function(){return s.mc(e),s.cc(2).update_nickname()}),s.Qb(7,"mat-icon"),s.uc(8,"refresh"),s.Pb(),s.Pb(),s.Pb(),s.Qb(9,"p",15),s.Qb(10,"mat-form-field",16),s.Qb(11,"mat-label"),s.uc(12,"Description"),s.Pb(),s.Mb(13,"textarea",18),s.Pb(),s.Qb(14,"button",13),s.Yb("click",function(){return s.mc(e),s.cc(2).update_info()}),s.Qb(15,"mat-icon"),s.uc(16,"refresh"),s.Pb(),s.Pb(),s.Pb(),s.Qb(17,"p",15),s.Qb(18,"mat-form-field",16),s.Qb(19,"mat-label"),s.uc(20,"Photo URL"),s.Pb(),s.Mb(21,"input",19),s.Pb(),s.Qb(22,"button",13),s.Yb("click",function(){return s.mc(e),s.cc(2).update_info()}),s.Qb(23,"mat-icon"),s.uc(24,"refresh"),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&e){const e=s.cc(2);s.hc("formGroup",e.form)}}function se(e,t){if(1&e&&(s.Qb(0,"mat-list-item",20),s.uc(1),s.Pb()),2&e){const e=t.$implicit;s.Bb(1),s.vc(e.name)}}function ae(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",2),s.Qb(1,"div",3),s.Qb(2,"mat-card",4),s.Qb(3,"mat-card-header"),s.Qb(4,"mat-card-title"),s.uc(5),s.Pb(),s.Pb(),s.Qb(6,"img",5),s.Yb("error",function(t){return s.mc(e),s.cc().changeSource(t)}),s.Pb(),s.Qb(7,"mat-card-content"),s.Qb(8,"p"),s.uc(9),s.Pb(),s.Pb(),s.Pb(),s.Qb(10,"div",6),s.sc(11,ne,25,1,"form",7),s.Qb(12,"h3",8),s.uc(13,"Connected Rooms"),s.Pb(),s.Mb(14,"mat-divider",9),s.Qb(15,"mat-list",10),s.sc(16,se,2,1,"mat-list-item",11),s.Pb(),s.Pb(),s.Pb(),s.Qb(17,"div",12),s.Qb(18,"button",13),s.Yb("click",function(){return s.mc(e),s.cc().backToPreviousPage()}),s.Qb(19,"mat-icon"),s.uc(20,"undo"),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&e){const e=s.cc();s.Bb(5),s.vc(e.profile.nickname),s.Bb(1),s.hc("src",e.profile.photo,s.nc),s.Bb(3),s.wc(" ",e.profile.desc," "),s.Bb(2),s.hc("ngIf",e.is_user_profile),s.Bb(5),s.hc("ngForOf",e.profile_rooms)}}function ce(e,t){1&e&&(s.Qb(0,"div",21),s.Mb(1,"mat-progress-spinner",22),s.Pb())}let le=(()=>{class e{constructor(e,t,o,i,r,n){this._fb=e,this._chat_service=t,this._activated_route=o,this._router=i,this.location=r,this._dialog_service=n,this.is_user_profile=!0,this.profile={_id:"",nickname:"",desc:"",photo:""},this.profile_rooms=[],this.is_loaded=!1,this.form=this._fb.group({nickname:[""],desc:[""],photo:[""]})}ngOnInit(){this._activated_route.params.pipe(Object(ee.a)(e=>this._chat_service.get_profile(e.profile_id)),Object(te.a)(e=>{this.is_user_profile=e.ok,this.profile=e.profile,this.update_form_values()}),Object(ee.a)(e=>this._chat_service.get_profile_rooms(e.profile._id)),Object(Y.a)(e=>(this._router.navigateByUrl("/chat/menu"),Object(G.a)(e.error)))).subscribe(e=>{e.ok?(this.profile_rooms=e.rooms,setTimeout(()=>{this.is_loaded=!0},500)):this._dialog_service.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}update_form_values(){this.form.patchValue({nickname:this.profile.nickname,desc:this.profile.desc,photo:this.profile.photo})}changeSource(e){e.target.src=F.a.empty_profile_photo}backToPreviousPage(){this.location.back()}update_nickname(){var e;const t=null===(e=this.form.get("nickname"))||void 0===e?void 0:e.value;this._chat_service.update_profile_nickname(this.profile._id,t).subscribe(e=>{var t;e.ok?(this.profile.nickname=null===(t=e.profile)||void 0===t?void 0:t.nickname,this.update_form_values()):this._dialog_service.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}update_info(){var e,t;const o=null===(e=this.form.get("desc"))||void 0===e?void 0:e.value,i=null===(t=this.form.get("photo"))||void 0===t?void 0:t.value;this._chat_service.update_profile_info(this.profile._id,o,i).subscribe(e=>{var t,o;e.ok?(this.profile.desc=null===(t=e.profile)||void 0===t?void 0:t.desc,this.profile.photo=null===(o=e.profile)||void 0===o?void 0:o.photo,this.update_form_values()):this._dialog_service.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(r.c),s.Lb(D),s.Lb(n.a),s.Lb(n.b),s.Lb(i.g),s.Lb(oe.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-profile"]],decls:3,vars:2,consts:[["class","flex-container d-flex flex-column animate__animated animate__fadeIn animation-speed",4,"ngIf","ngIfElse"],["spinner",""],[1,"flex-container","d-flex","flex-column","animate__animated","animate__fadeIn","animation-speed"],[1,"content","d-flex","flex-row","flex-wrap"],[1,"profile-card","m-md-3"],["mat-card-image","","alt","Profile Image",3,"src","error"],[1,"ps-3","pt-3","pe-md-3","flex-grow-1"],["class","pb-2",3,"formGroup",4,"ngIf"],[1,"ms-2"],[1,"mx-2","pb-1"],["role","list"],["role","listitem",4,"ngFor","ngForOf"],[1,"footer"],["mat-mini-fab","","color","primary","aria-label","Back to last page menu",1,"m-2","float-end",3,"click"],[1,"pb-2",3,"formGroup"],[1,"d-flex","flex-row"],[1,"flex-grow-1"],["formControlName","nickname","matInput","","placeholder","Your nickname goes here"],["formControlName","desc","matInput","","placeholder","Describe your profile"],["formControlName","photo","matInput","","placeholder","https://some-domain.com/..."],["role","listitem"],[1,"flex-container-spinner","d-flex","justify-content-center","align-items-center"],["diameter","60","color","primary","mode","indeterminate","value","80"]],template:function(e,t){if(1&e&&(s.sc(0,ae,21,5,"div",0),s.sc(1,ce,2,0,"ng-template",null,1,s.tc)),2&e){const e=s.lc(2);s.hc("ngIf",t.is_loaded)("ngIfElse",e)}},directives:[i.k,ie.a,ie.e,ie.i,ie.f,ie.d,$.a,u.a,i.j,m.a,b.a,r.n,r.j,r.e,k.b,k.e,r.b,Q.a,r.i,r.d,u.c,re.a],styles:[".flex-container[_ngcontent-%COMP%]{height:calc(100% - 92px)}.flex-container-spinner[_ngcontent-%COMP%]{height:50%}@media (min-width:600px){.flex-container[_ngcontent-%COMP%]{height:calc(100% - 100px)}}",".content[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:scroll}.profile-card[_ngcontent-%COMP%]{max-width:400px}.profile-image[_ngcontent-%COMP%]{background-size:cover}.input-full-width[_ngcontent-%COMP%]{min-width:100%}.footer[_ngcontent-%COMP%]{flex-shrink:0}"]}),e})();const me=["chat_window"],be=function(e){return{"right-message":e}};function ue(e,t){if(1&e&&(s.Qb(0,"mat-list-item",23),s.uc(1),s.Pb()),2&e){const e=t.$implicit,o=s.cc().$implicit,i=s.cc(2);s.hc("ngClass",s.jc(2,be,o.nickname==i.profile_info.nickname)),s.Bb(1),s.wc(" ",e," ")}}const _e=function(e){return{"right-avatar":e}};function de(e,t){if(1&e&&(s.Qb(0,"div"),s.Qb(1,"div",21),s.uc(2),s.Pb(),s.sc(3,ue,2,4,"mat-list-item",22),s.Pb()),2&e){const e=t.$implicit,o=s.cc(2);s.Bb(1),s.hc("ngClass",s.jc(3,_e,e.nickname==o.profile_info.nickname)),s.Bb(1),s.wc(" ",e.nickname," "),s.Bb(1),s.hc("ngForOf",e.msgs)}}function he(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",2),s.Qb(1,"mat-card",3),s.Qb(2,"mat-card-header"),s.Qb(3,"div",4),s.Qb(4,"img",5),s.Yb("error",function(t){return s.mc(e),s.cc().changeSource(t)}),s.Pb(),s.Pb(),s.Qb(5,"mat-card-title"),s.uc(6),s.Pb(),s.Qb(7,"mat-card-subtitle",6),s.uc(8),s.Pb(),s.Mb(9,"div",7),s.Qb(10,"button",8),s.Qb(11,"mat-icon"),s.uc(12,"people"),s.Pb(),s.Pb(),s.Qb(13,"button",9),s.Yb("click",function(){return s.mc(e),s.cc().logout_user()}),s.Qb(14,"mat-icon"),s.uc(15,"logout"),s.Pb(),s.Pb(),s.Pb(),s.Qb(16,"mat-card-content",10,11),s.Qb(18,"mat-list",12),s.sc(19,de,4,5,"div",13),s.Pb(),s.Pb(),s.Qb(20,"mat-card-actions"),s.Qb(21,"form",14),s.Yb("ngSubmit",function(){return s.mc(e),s.cc().send_message()}),s.Qb(22,"div",15),s.Qb(23,"div",16),s.Mb(24,"input",17),s.Pb(),s.Qb(25,"div",18),s.Qb(26,"button",19),s.Qb(27,"mat-icon"),s.uc(28,"send"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Mb(29,"app-user-list",20),s.Pb()}if(2&e){const e=s.cc();s.Bb(4),s.hc("src",e.room_info.photo,s.nc),s.Bb(2),s.vc(e.room_info.name),s.Bb(2),s.vc(e.room_info.desc),s.Bb(2),s.hc("routerLink","/chat/users/"+e.room_info.id+"/"+e.profile_info.id),s.Bb(9),s.hc("ngForOf",e.room_msgs),s.Bb(2),s.hc("formGroup",e.form),s.Bb(5),s.hc("disabled",e.form.invalid),s.Bb(3),s.hc("user_list_type","Room users")("profiles",e.room_info.profiles)}}function pe(e,t){1&e&&(s.Qb(0,"div",24),s.Mb(1,"mat-progress-spinner",25),s.Pb())}let fe=(()=>{class e{constructor(e,t,o,i,n){this._fb=e,this._activ_route=t,this._chat_service=o,this._dialog=i,this._router=n,this.form=this._fb.group({msg:["",[r.m.required]]}),this.is_loaded=!1}get room_info(){return this._room?{id:this._room._id,name:this._room.name,desc:this._room.desc,photo:this._room.photo,profiles:this._room.profiles}:{id:"No id",name:"Room Name",desc:"Room Desc",photo:"Room Image",profiles:[]}}get profile_info(){return this._profile?{id:this._profile._id,nickname:this._profile.nickname}:{id:"No id",nickname:"No Nickname"}}get room_msgs(){return this._room?this.prepare_msg_data(this._room.msgs):[]}ngOnInit(){this._activ_route.params.pipe(Object(ee.a)(e=>this._chat_service.get_room(e.room_id))).subscribe(e=>{this._room=e.room}),this._activ_route.params.pipe(Object(ee.a)(e=>this._chat_service.get_profile(e.profile_id))).subscribe(e=>{this._profile=e.profile}),this._listen_message_subs=this._activ_route.params.pipe(Object(ee.a)(e=>this._chat_service.get_messages(e.room_id))).subscribe(e=>{var t;null===(t=this._room.msgs)||void 0===t||t.push(e),this.see_last_messages()}),this._listen_logout_user_subs=this._activ_route.params.pipe(Object(ee.a)(e=>this._chat_service.listen_logout_users(e.room_id))).subscribe(e=>{this._room.profiles=this._room.profiles.filter(t=>t.nickname!==e.nickname)}),this._listen_new_logged_users_subs=this._activ_route.params.pipe(Object(ee.a)(e=>this._chat_service.listen_new_logged_users(e.room_id))).subscribe(e=>{this._room.profiles.push(e)})}ngAfterViewInit(){setTimeout(()=>{this.is_loaded=!0},500),this.see_last_messages()}ngOnDestroy(){this._listen_message_subs.unsubscribe(),this._listen_logout_user_subs.unsubscribe(),this._listen_new_logged_users_subs.unsubscribe()}send_message(){if(this.form.invalid)return void this.form.markAllAsTouched();const e={room_id:this.room_info.id,nickname:this.profile_info.nickname,msg:this.form.get("msg").value};this._chat_service.send_message(e).then(e=>this.form.reset()).catch(e=>{this.openGeneralDialog({title:e.msg,icon:"warning_amber",msg:"The room has been deleted by its creator, do not worry, we already left the room for you"}),this._router.navigateByUrl("/chat/menu")})}logout_user(){const e={room_id:this._room._id,nickname:this._profile.nickname};this.openGeneralDialogResponse({title:"Are you sure?",icon:"priority_high",msg:"Proceed with Room logout?",response:!0}).subscribe(t=>{t&&(this._chat_service.logout_room(e),this._router.navigateByUrl("/chat/menu"))})}prepare_msg_data(e){let t=[];for(let o of e){let e=t[t.length-1];void 0===e||e.nickname!==o.chatuser.nickname?t.push({nickname:o.chatuser.nickname,msgs:[o.msg]}):e.msgs.push(o.msg)}return t}see_last_messages(){setTimeout(()=>{this.chat_window.nativeElement.scrollTop=this.chat_window.nativeElement.scrollHeight},500)}changeSource(e){e.target.src=F.a.empty_chat_photo}openGeneralDialog(e){this._dialog.open(R.a,{width:"250px",data:e})}openGeneralDialogResponse(e){return this._dialog.open(R.a,{width:"250px",data:e}).afterClosed()}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(r.c),s.Lb(n.a),s.Lb(D),s.Lb(w.b),s.Lb(n.b))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&s.xc(me,1),2&e){let e;s.kc(e=s.Zb())&&(t.chat_window=e.first)}},decls:3,vars:2,consts:[["class","flex-container d-flex flex-row animate__animated animate__fadeIn animation-speed",4,"ngIf","ngIfElse"],["spinner",""],[1,"flex-container","d-flex","flex-row","animate__animated","animate__fadeIn","animation-speed"],[1,"flex-fill","d-flex","flex-column"],["mat-card-avatar",""],["alt","header image",1,"header-img",3,"src","error"],[1,"chat-description"],[1,"spacer"],["mat-mini-fab","","color","accent","aria-label","Button Room connected profiles",1,"me-2",3,"routerLink"],["mat-mini-fab","","color","primary","aria-label","Go back to chat menu",3,"click"],[1,"chat-content"],["chat_window",""],["role","list"],[4,"ngFor","ngForOf"],["autocomplete","false",3,"formGroup","ngSubmit"],[1,"row","gx-3"],[1,"col-10","col-md-11","ps-3"],["type","text","formControlName","msg",1,"form-control"],[1,"col-2","col-md-1"],["mat-mini-fab","","type","submit","color","primary","aria-label","Send button",3,"disabled"],[1,"chat-users",3,"user_list_type","profiles"],[1,"avatar",3,"ngClass"],["class","chat-message break-word","role","listitem",3,"ngClass",4,"ngFor","ngForOf"],["role","listitem",1,"chat-message","break-word",3,"ngClass"],[1,"flex-container-spinner","d-flex","justify-content-center","align-items-center"],["diameter","60","color","primary","mode","indeterminate","value","80"]],template:function(e,t){if(1&e&&(s.sc(0,he,30,9,"div",0),s.sc(1,pe,2,0,"ng-template",null,1,s.tc)),2&e){const e=s.lc(2);s.hc("ngIf",t.is_loaded)("ngIfElse",e)}},directives:[i.k,ie.a,ie.e,ie.c,ie.i,ie.h,m.a,n.c,b.a,ie.d,u.a,i.j,ie.b,r.n,r.j,r.e,r.b,r.i,r.d,V,i.i,u.c,re.a],styles:[".flex-container[_ngcontent-%COMP%]{height:calc(100% - 92px)}.flex-container-spinner[_ngcontent-%COMP%]{height:50%}@media (min-width:600px){.flex-container[_ngcontent-%COMP%]{height:calc(100% - 100px)}}",".chat-users[_ngcontent-%COMP%]{min-width:30%;display:none}.chat-content[_ngcontent-%COMP%]{flex:1 1 auto;border:2px solid grey;border-radius:5px;height:auto;overflow-y:scroll}.header-img[_ngcontent-%COMP%]{vertical-align:middle;width:50px;height:50px;border-radius:50%}.chat-description[_ngcontent-%COMP%]{width:8rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.avatar[_ngcontent-%COMP%]{display:inline-block;padding:.2rem 1rem;margin:1rem 0 0 1rem;background-color:coral;border:1px solid grey;border-radius:5px 5px 0 5px}.avatar-img[_ngcontent-%COMP%]{max-width:50%}.right-avatar[_ngcontent-%COMP%]{margin:1rem 0 0 7rem}.chat-message[_ngcontent-%COMP%]{width:auto;height:auto;margin:0 1rem .5rem;padding:.5rem 0;background-color:#f3f3f3;color:#333;border:1px solid grey;border-radius:5px}.right-message[_ngcontent-%COMP%]{margin:0 1rem .5rem 7rem}.break-word[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-wrap:anywhere;-webkit-hyphens:auto;hyphens:auto}@media (min-width:600px){.chat-users[_ngcontent-%COMP%]{display:block}.chat-description[_ngcontent-%COMP%]{width:15rem}}"]}),e})();function ge(e,t){if(1&e&&(s.Qb(0,"div",2),s.Qb(1,"div",3),s.Qb(2,"h2"),s.uc(3,"Room name"),s.Pb(),s.Mb(4,"mat-divider"),s.Mb(5,"app-user-list",4),s.Pb(),s.Qb(6,"div",5),s.Qb(7,"button",6),s.Qb(8,"mat-icon"),s.uc(9,"undo"),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&e){const e=s.cc();s.Bb(5),s.hc("user_list_type","Room users")("profiles",e.room_users),s.Bb(2),s.hc("routerLink","/chat/room/"+e.room_id+"/"+e.profile_id)}}function ve(e,t){1&e&&(s.Qb(0,"div",7),s.Mb(1,"mat-progress-spinner",8),s.Pb())}let Pe=(()=>{class e{constructor(e,t){this._ar=e,this._chat_service=t,this.profile_id="",this.room_id="",this.room_users=[],this.is_loaded=!1}ngOnInit(){this._ar.params.pipe(Object(te.a)(e=>{this.room_id=e.room_id,this.profile_id=e.profile_id}),Object(ee.a)(e=>this._chat_service.get_room_profiles(e.room_id))).subscribe(e=>{this.room_users=e.profiles,setTimeout(()=>{this.is_loaded=!0},500)})}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(n.a),s.Lb(D))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-chat-users"]],decls:3,vars:2,consts:[["class","flex-container d-flex flex-column animate__animated animate__fadeIn animation-speed",4,"ngIf","ngIfElse"],["spinner",""],[1,"flex-container","d-flex","flex-column","animate__animated","animate__fadeIn","animation-speed"],[1,"content","p-3"],[3,"user_list_type","profiles"],[1,"footer"],["mat-mini-fab","","color","primary","aria-label","Example icon button with a menu icon",1,"m-2","float-end",3,"routerLink"],[1,"flex-container-spinner","d-flex","justify-content-center","align-items-center"],["diameter","60","color","primary","mode","indeterminate","value","80"]],template:function(e,t){if(1&e&&(s.sc(0,ge,10,3,"div",0),s.sc(1,ve,2,0,"ng-template",null,1,s.tc)),2&e){const e=s.lc(2);s.hc("ngIf",t.is_loaded)("ngIfElse",e)}},directives:[i.k,$.a,V,m.a,n.c,b.a,re.a],styles:[".flex-container[_ngcontent-%COMP%]{height:calc(100% - 92px)}.flex-container-spinner[_ngcontent-%COMP%]{height:50%}@media (min-width:600px){.flex-container[_ngcontent-%COMP%]{height:calc(100% - 100px)}}",".content[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:scroll}.profile-link[_ngcontent-%COMP%]{cursor:pointer}.footer[_ngcontent-%COMP%]{flex-shrink:0}"]}),e})();function we(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",22),s.Yb("click",function(){return s.mc(e),s.cc(2).update_room_password()}),s.uc(1," Add Password "),s.Pb()}}function ke(e,t){if(1&e){const e=s.Rb();s.Qb(0,"button",22),s.Yb("click",function(){return s.mc(e),s.cc(2).update_room_password()}),s.uc(1," Change password "),s.Pb()}}function Qe(e,t){if(1&e&&(s.Qb(0,"mat-list-item",23),s.uc(1),s.Pb()),2&e){const e=t.$implicit;s.Bb(1),s.wc(" ",e.nickname," ")}}function xe(e,t){if(1&e){const e=s.Rb();s.Qb(0,"div",2),s.Qb(1,"div",3),s.Qb(2,"mat-card",4),s.Qb(3,"mat-card-header"),s.Qb(4,"mat-card-title"),s.uc(5),s.Pb(),s.Pb(),s.Qb(6,"img",5),s.Yb("error",function(t){return s.mc(e),s.cc().changeSource(t)}),s.Pb(),s.Qb(7,"mat-card-content"),s.Qb(8,"p"),s.uc(9),s.Pb(),s.Pb(),s.Pb(),s.Qb(10,"div",6),s.Qb(11,"form",7),s.Qb(12,"p",8),s.Qb(13,"mat-form-field",9),s.Qb(14,"mat-label"),s.uc(15,"Room name"),s.Pb(),s.Mb(16,"input",10),s.Pb(),s.Qb(17,"button",11),s.Yb("click",function(){return s.mc(e),s.cc().update_room_name()}),s.Qb(18,"mat-icon"),s.uc(19,"refresh"),s.Pb(),s.Pb(),s.Pb(),s.Qb(20,"p",8),s.Qb(21,"mat-form-field",9),s.Qb(22,"mat-label"),s.uc(23,"Description"),s.Pb(),s.Mb(24,"textarea",12),s.Pb(),s.Qb(25,"button",13),s.Yb("click",function(){return s.mc(e),s.cc().update_room_info()}),s.Qb(26,"mat-icon"),s.uc(27,"refresh"),s.Pb(),s.Pb(),s.Pb(),s.Qb(28,"p",8),s.Qb(29,"mat-form-field",9),s.Qb(30,"mat-label"),s.uc(31,"Photo URL"),s.Pb(),s.Mb(32,"input",14),s.Pb(),s.Qb(33,"button",13),s.Yb("click",function(){return s.mc(e),s.cc().update_room_info()}),s.Qb(34,"mat-icon"),s.uc(35,"refresh"),s.Pb(),s.Pb(),s.Pb(),s.Qb(36,"p",8),s.sc(37,we,2,0,"button",15),s.sc(38,ke,2,0,"ng-template",null,16,s.tc),s.Pb(),s.Pb(),s.Mb(40,"mat-divider",17),s.Qb(41,"h3"),s.uc(42,"Connected Profiles:"),s.Pb(),s.Qb(43,"mat-list",18),s.sc(44,Qe,2,1,"mat-list-item",19),s.Pb(),s.Pb(),s.Pb(),s.Qb(45,"div",20),s.Qb(46,"button",21),s.Qb(47,"mat-icon"),s.uc(48,"home"),s.Pb(),s.Pb(),s.Pb(),s.Pb()}if(2&e){const e=s.lc(39),t=s.cc();s.Bb(5),s.wc(" ",t.room.name," "),s.Bb(1),s.hc("src",t.room.photo,s.nc),s.Bb(3),s.wc(" ",t.room.desc," "),s.Bb(2),s.hc("formGroup",t.form),s.Bb(26),s.hc("ngIf",!t.room.has_password)("ngIfElse",e),s.Bb(7),s.hc("ngForOf",t.room.profiles)}}function ye(e,t){1&e&&(s.Qb(0,"div",24),s.Mb(1,"mat-progress-spinner",25),s.Pb())}let Oe=(()=>{class e{constructor(e,t,o,i){this._fb=e,this._activated_route=t,this._chat_service=o,this._dialog_service=i,this.room={_id:"",name:""},this.is_loaded=!1,this.form=this._fb.group({name:[""],desc:[""],photo:[""]})}ngOnInit(){this._activated_route.params.pipe(Object(ee.a)(e=>this._chat_service.get_room(e.room_id))).subscribe(e=>{this.room=e.room,this.update_form_values(),setTimeout(()=>{this.is_loaded=!0},500)})}update_form_values(){this.form.patchValue({name:this.room.name,desc:this.room.desc,photo:this.room.photo})}changeSource(e){e.target.src=F.a.empty_chat_photo}update_room_name(){var e;const t=null===(e=this.form.get("name"))||void 0===e?void 0:e.value;this._chat_service.update_room_name(this.room._id,t).subscribe(e=>{var t;e.ok?(this.room.name=null===(t=e.room)||void 0===t?void 0:t.name,this.update_form_values()):this._dialog_service.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}update_room_info(){var e,t;const o=null===(e=this.form.get("desc"))||void 0===e?void 0:e.value,i=null===(t=this.form.get("photo"))||void 0===t?void 0:t.value;this._chat_service.update_room_info(this.room._id,o,i).subscribe(e=>{var t,o;e.ok?(this.room.desc=null===(t=e.room)||void 0===t?void 0:t.desc,this.room.photo=null===(o=e.room)||void 0===o?void 0:o.photo,this.update_form_values()):this._dialog_service.openGeneralDialog({title:"Error",icon:"warning_amber",msg:e.msg})})}update_room_password(){this._dialog_service.openPasswordDialog({title:"Insert Password",icon:"help_outline",msg:"Insert the room pasword",has_password:this.room.has_password}).subscribe(e=>{void 0!==e&&this._chat_service.update_room_password(this.room._id,e.new_password,e.old_password).subscribe(e=>{e.ok?(this.room.has_password=!0,this._dialog_service.openGeneralDialog({title:"Success",icon:"done",msg:e.msg})):this._dialog_service.openGeneralDialog({title:"error",icon:"warning_amber",msg:e.msg})})})}}return e.\u0275fac=function(t){return new(t||e)(s.Lb(r.c),s.Lb(n.a),s.Lb(D),s.Lb(oe.a))},e.\u0275cmp=s.Fb({type:e,selectors:[["app-chat-config"]],decls:3,vars:2,consts:[["class","flex-container d-flex flex-column animate__animated animate__fadeIn animation-speed",4,"ngIf","ngIfElse"],["spinner",""],[1,"flex-container","d-flex","flex-column","animate__animated","animate__fadeIn","animation-speed"],[1,"content","d-flex","flex-row","flex-wrap"],[1,"profile-card","m-md-3"],["mat-card-image","","alt","Profile Image",3,"src","error"],[1,"ps-3","pt-3","pe-md-3","flex-grow-1"],[1,"pb-2",3,"formGroup"],[1,"d-flex","flex-row"],[1,"flex-grow-1"],["formControlName","name","matInput","","placeholder","The Room name goes here"],["mat-mini-fab","","color","primary","aria-label","Update room name",1,"m-2","float-end",3,"click"],["formControlName","desc","matInput","","placeholder","Describe the chat room"],["mat-mini-fab","","color","primary","aria-label","Update room info - description",1,"m-2","float-end",3,"click"],["formControlName","photo","matInput","","placeholder","https://some-domain.com/..."],["mat-raised-button","","color","primary",3,"click",4,"ngIf","ngIfElse"],["haspassword",""],[1,"mx-2","pb-4"],["role","list"],["role","listitem",4,"ngFor","ngForOf"],[1,"footer"],["mat-mini-fab","","color","primary","routerLink","/chat/menu","aria-label","Example icon button with a menu icon",1,"m-2","float-end"],["mat-raised-button","","color","primary",3,"click"],["role","listitem"],[1,"flex-container-spinner","d-flex","justify-content-center","align-items-center"],["diameter","60","color","primary","mode","indeterminate","value","80"]],template:function(e,t){if(1&e&&(s.sc(0,xe,49,7,"div",0),s.sc(1,ye,2,0,"ng-template",null,1,s.tc)),2&e){const e=s.lc(2);s.hc("ngIf",t.is_loaded)("ngIfElse",e)}},directives:[i.k,ie.a,ie.e,ie.i,ie.f,ie.d,r.n,r.j,r.e,k.b,k.e,r.b,Q.a,r.i,r.d,m.a,b.a,$.a,u.a,i.j,n.c,u.c,re.a],styles:[".flex-container[_ngcontent-%COMP%]{height:calc(100% - 92px)}.flex-container-spinner[_ngcontent-%COMP%]{height:50%}@media (min-width:600px){.flex-container[_ngcontent-%COMP%]{height:calc(100% - 100px)}}",".content[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:scroll}.profile-card[_ngcontent-%COMP%]{max-width:400px}.profile-image[_ngcontent-%COMP%]{background-size:cover}.input-full-width[_ngcontent-%COMP%]{min-width:100%}.footer[_ngcontent-%COMP%]{flex-shrink:0}"]}),e})();const Ie=[{path:"",component:P,children:[{path:"menu",component:Z},{path:"room/:room_id/:profile_id",component:fe,canActivate:[(()=>{class e{constructor(e,t){this._chat_service=e,this._router=t}canActivate(e){const t=e.paramMap.get("profile_id"),o=e.paramMap.get("room_id");return this._chat_service.check_if_profile_can_loggin(t,o).pipe(Object(te.a)(e=>{e||this._router.navigateByUrl("/chat/menu")}))}}return e.\u0275fac=function(t){return new(t||e)(s.Ub(D),s.Ub(n.b))},e.\u0275prov=s.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()]},{path:"users/:room_id/:profile_id",component:Pe},{path:"profile/:profile_id",component:le},{path:"room-config/:room_id",component:Oe},{path:"**",redirectTo:"menu"}]}];let Ce=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},imports:[[n.e.forChild(Ie)],n.e]}),e})();var Me=o("hctd"),je=o("PCNd");let Be=(()=>{class e{}return e.\u0275mod=s.Jb({type:e}),e.\u0275inj=s.Ib({factory:function(t){return new(t||e)},imports:[[i.b,Ce,r.l,Me.a,je.a]]}),e})()}}]);